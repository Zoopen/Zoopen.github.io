(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-16914ce8"],{"184c":function(t,s,e){},"49a8":function(t,s,e){"use strict";e.r(s);var o=function(){var t=this,s=t.$createElement,e=t._self._c||s;return e("div",{staticClass:"search-page"},[e("van-search",{attrs:{placeholder:t.$store.state.hotWords[t.$store.state.hotWordsIndex],shape:"round","left-icon":"",clearable:!1,"show-action":""},on:{search:t.onSearch,focus:function(s){t.showsuggest=!0}},model:{value:t.searchText,callback:function(s){t.searchText=s},expression:"searchText"}},[t.searchText?e("div",{attrs:{slot:"right-icon"},slot:"right-icon"},[e("van-icon",{attrs:{color:"lightgray",name:"clear"},on:{click:function(s){t.searchText=""}}})],1):t._e(),e("div",{staticClass:"actionbtn",attrs:{slot:"action"},on:{click:t.onCancel},slot:"action"},[t._v("取消")])]),t.searchText?t._e():e("div",{staticClass:"search-recommend"},[e("div",{staticClass:"hotsearchword"},[e("van-cell",{attrs:{to:"searchhotwordspage"}},[e("template",{slot:"title"},[e("span",{staticClass:"custom-title"},[t._v("搜索热词")])]),e("template",{slot:"default"},[e("span",{staticClass:"custom-title-right"},[t._v("查看更多 ")])]),e("van-icon",{attrs:{name:"arrow"}})],2),e("div",{staticClass:"hotsearchword-content"},t._l(t.searchHotWords,(function(s,o){return e("van-tag",{key:o,attrs:{size:"medium",plain:"",round:""},on:{click:function(e){return t.getBooks(s.word)}}},[t._v(t._s(s.word))])})),1)],1),e("div",{staticClass:"hotrecomment"},[e("van-cell",[e("template",{slot:"title"},[e("span",{staticClass:"custom-title"},[t._v("热门推荐")])]),e("template",{slot:"default"},[e("span",{staticClass:"custom-title-right",on:{click:t.changeHotWords}},[t._v("换一批 ")])]),e("van-icon",{attrs:{name:"replay"}})],2),e("van-row",t._l(t.hotWords,(function(s,o){return e("van-col",{key:o,attrs:{span:"12"},on:{click:function(e){return t.toBookDetail(s.book)}}},[e("van-icon",{attrs:{name:"orders-o"}}),e("span",[t._v(t._s(s.word))])],1)})),1)],1)]),t.searchText&&t.showsuggest?e("div",{staticClass:"search-suggest"},[e("div",{staticClass:"scroll-list-wrap"},[e("cube-scroll",{ref:"scroll"},[e("van-list",t._l(t.suggest,(function(s,o){return e("van-cell",{key:o,on:{click:function(e){return t.getBookId(s)}}},[[e("van-icon",{attrs:{name:"orders-o"}}),e("span",[t._v(t._s(s))])]],2)})),1)],1)],1)]):t._e(),t.searchText&&!t.showsuggest?e("div",{staticClass:"search-detail"},[e("van-tabs",{attrs:{"line-width":"15px","line-height":"2px","title-active-color":"#db2016",animated:""},model:{value:t.active,callback:function(s){t.active=s},expression:"active"}},[e("van-tab",{attrs:{title:"书籍"}},[e("div",{staticClass:"scroll-list-wrap"},[e("cube-scroll",{ref:"scroll"},[e("van-list",{attrs:{finished:t.finished,"finished-text":"到底了"},model:{value:t.loading,callback:function(s){t.loading=s},expression:"loading"}},t._l(t.books,(function(s,o){return e("van-cell",{key:o,staticClass:"search-detail-list",on:{click:function(e){return t.toBookDetail(s._id)}}},[e("van-row",{attrs:{type:"flex"}},[e("van-col",{staticClass:"search-detail-list-img",attrs:{span:"6"}},[e("van-image",{attrs:{width:"75",height:"100",src:s.cover}})],1),e("van-col",{staticClass:"search-detail-list-info",attrs:{span:"18"}},[e("div",{staticClass:"title"},[t._v(t._s(s.title))]),e("div",{staticClass:"shortIntro"},[t._v(t._s(s.shortIntro))]),e("div",{staticClass:"bottom"},[e("span",{staticClass:"author"},[t._v(t._s(s.author))]),e("van-tag",{staticClass:"tag",attrs:{plain:""}},[t._v(t._s(s.cat))])],1)])],1)],1)})),1)],1)],1)]),e("van-tab",{attrs:{title:"漫画"}},[t._v("内容 2")]),e("van-tab",{attrs:{title:"书单"}},[t._v("内容 3")]),e("van-tab",{attrs:{title:"社区"}},[t._v("内容 4")])],1)],1):t._e()],1)},a=[],i=(e("4160"),e("fb6a"),e("159b"),{data:function(){return{searchText:"",searchHotWords:null,hotWords:null,active:0,value1:0,value2:"a",option1:[{text:"综合",value:0},{text:"按人气",value:1},{text:"按留存",value:2},{text:"按评分",value:3},{text:"按字数",value:4}],option2:[{text:"默认排序",value:"a"},{text:"好评排序",value:"b"},{text:"销量排序",value:"c"}],books:null,suggest:null,showsuggest:!1,list:[],loading:!1,finished:!1,scroll:null}},watch:{books:function(){this.books&&this.books.forEach((function(t){t.cover=unescape(t.cover.slice(7))}))},searchText:function(){var t=this;this.searchText&&this.axios.get(this.$origin+"/auto-complete",{params:{query:this.searchText}}).then((function(s){window.console.log(s),t.suggest=s.data.keywords}))}},created:function(){window.console.log(this.$route),this.$route.query.searchText&&(this.searchText=this.$route.query.searchText),this.searchHotWords=this.$store.state.searchHotWords.slice(0,8),this.changeHotWords()},beforeRouteEnter:function(t,s,e){e((function(t){window.console.log(s),"/bookdetail"!==s.path&&t.$el.querySelector(".van-search input").focus(),"/searchhotwordspage"==s.path&&(t.$el.querySelector(".van-search input").blur(),t.getBooks(t.$route.query.searchText))}))},methods:{getBookId:function(t){var s=this;this.axios.get(this.$origin+"/search",{params:{keyword:t}}).then((function(t){s.toBookDetail(t.data.books[0]._id)}))},toBookDetail:function(t){this.$toast.loading({duration:0,forbidClick:!0,message:"加载中..."}),this.$router.push({path:"bookdetail",query:{bookId:t}})},getBooks:function(){var t=this,s=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";s&&(this.searchText=s),window.console.log("回车"),this.showsuggest=!1,this.searchText&&(this.books=null,this.finished=!1,this.loading=!0,this.axios.get(this.$origin+"/search",{params:{keyword:this.searchText}}).then((function(s){window.console.log(s),t.books=s.data.books,t.loading=!1,0==t.loading&&(t.finished=!0)})))},onSearch:function(){window.console.log("onSearch"),this.getBooks()},onCancel:function(){window.console.log("onCancel"),this.$route.query.searchText?this.$router.go(-2):this.$router.go(-1),this.searchText=""},changeHotWords:function(){this.hotWords=this.$store.state.newHotWords.slice(0,6),this.$store.commit("changeHotWords")}}}),n=i,c=(e("507e"),e("2877")),r=Object(c["a"])(n,o,a,!1,null,null,null);s["default"]=r.exports},"507e":function(t,s,e){"use strict";var o=e("184c"),a=e.n(o);a.a}}]);
//# sourceMappingURL=chunk-16914ce8.95f736a0.js.map